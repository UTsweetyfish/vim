Index: vim/src/ex_cmds.c
===================================================================
--- vim.orig/src/ex_cmds.c
+++ vim/src/ex_cmds.c
@@ -866,6 +866,8 @@ ex_copy(linenr_T line1, linenr_T line2,
     }
 
     appended_lines_mark(n, count);
+    if (VIsual_active)
+    check_pos(curbuf, &VIsual);
 
     msgmore((long)count);
 }
Index: vim/src/testdir/test_visual.vim
===================================================================
--- vim.orig/src/testdir/test_visual.vim
+++ vim/src/testdir/test_visual.vim
@@ -411,6 +411,17 @@ func Test_visual_block_insert_round_off(
   bwipe!
 endfunc
 
+" this was leaving the end of the Visual area beyond the end of a line
+func Test_visual_ex_copy_line()
+  new
+  call setline(1, ["aaa", "bbbbbbbbbxbb"])
+  /x
+  exe "normal ggvjfxO"
+  t0
+  normal gNU
+  bwipe!
+endfunc
+
 func Test_Visual_paragraph_textobject()
   new
   let lines =<< trim [END]
