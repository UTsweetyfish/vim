Index: vim/src/edit.c
===================================================================
--- vim.orig/src/edit.c
+++ vim/src/edit.c
@@ -4415,7 +4415,8 @@ bracketed_paste(paste_mode_T mode, int d
 		    break;
 
 		case PASTE_EX:
-		    if (gap != NULL && ga_grow(gap, idx) == OK)
+		    // add one for the NUL that is going to be appended
+		    if (gap != NULL && ga_grow(gap, idx + 1) == OK)
 		    {
 			mch_memmove((char *)gap->ga_data + gap->ga_len,
 							     buf, (size_t)idx);
Index: vim/src/testdir/test_paste.vim
===================================================================
--- vim.orig/src/testdir/test_paste.vim
+++ vim/src/testdir/test_paste.vim
@@ -100,6 +100,16 @@ func Test_paste_onechar()
   close!
 endfunc
 
+" bracketed paste in Ex-mode
+func Test_paste_ex_mode()
+  unlet! foo
+  call feedkeys("Qlet foo=\"\<Esc>[200~foo\<CR>bar\<Esc>[201~\"\<CR>vi\<CR>", 'xt')
+  call assert_equal("foo\rbar", foo)
+
+  " pasting more than 40 bytes
+  exe "norm Q\<PasteStart>0000000000000000000000000000000000000000000000000000000000000000000000\<C-C>"
+endfunc
+
 func Test_paste_visual_mode()
   new
   call setline(1, 'here are some words')
