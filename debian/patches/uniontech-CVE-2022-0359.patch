Index: vim/src/ex_getln.c
===================================================================
--- vim.orig/src/ex_getln.c
+++ vim/src/ex_getln.c
@@ -1513,7 +1513,7 @@ init_ccline(int firstc, int indent)
     ccline.cmdindent = (firstc > 0 ? indent : 0);
 
     // alloc initial ccline.cmdbuff
-    alloc_cmdbuff(exmode_active ? 250 : indent + 1);
+    alloc_cmdbuff(indent + 50);
     if (ccline.cmdbuff == NULL)
 	return FAIL;
     ccline.cmdlen = ccline.cmdpos = 0;
Index: vim/src/testdir/test_ex_mode.vim
===================================================================
--- vim.orig/src/testdir/test_ex_mode.vim
+++ vim/src/testdir/test_ex_mode.vim
@@ -134,6 +134,15 @@ func Test_open_command_flush_line()
   bwipe!
 endfunc
 
+func Test_ex_mode_large_indent()
+  new
+  set ts=500 ai
+  call setline(1, "\t")
+  exe "normal gQi\<CR>."
+  set ts=8 noai
+  bwipe!
+endfunc
+
 " Test for :g/pat/visual to run vi commands in Ex mode
 " This used to hang Vim before 8.2.0274.
 func Test_Ex_global()
