Index: vim/src/normal.c
===================================================================
--- vim.orig/src/normal.c
+++ vim/src/normal.c
@@ -3866,8 +3866,10 @@ get_visual_text(
 	    *pp = ml_get_pos(&VIsual);
 	    *lenp = curwin->w_cursor.col - VIsual.col + 1;
 	}
-	if (has_mbyte)
-	    // Correct the length to include the whole last character.
+	if (**pp == NUL)
+	    *lenp = 0;
+	if (has_mbyte && *lenp > 0)
+	    // Correct the length to include all bytes of the last character.
 	    *lenp += (*mb_ptr2len)(*pp + (*lenp - 1)) - 1;
     }
     reset_VIsual_and_resel();
Index: vim/src/testdir/test_visual.vim
===================================================================
--- vim.orig/src/testdir/test_visual.vim
+++ vim/src/testdir/test_visual.vim
@@ -385,6 +385,14 @@ func Test_Visual_sentence_textobject()
   bwipe!
 endfunc
 
+func Test_visual_block_ctrl_w_f()
+  " Emtpy block selected in new buffer should not result in an error.
+  au! BufNew foo sil norm f
+  edit foo
+
+  au! BufNew
+endfunc
+
 func Test_Visual_paragraph_textobject()
   new
   let lines =<< trim [END]
